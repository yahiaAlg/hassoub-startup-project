<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ© - Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ Ù„Ù„Ø£Ø·ÙØ§Ù„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            text-align: center;
            color: white;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .week-indicator {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .week-badge {
            background: rgba(255,255,255,0.3);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .week-badge.active {
            background: white;
            color: #f5576c;
            transform: scale(1.1);
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 3px solid #e9ecef;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .stat-card .icon {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card .label {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .stat-card .value {
            font-size: 1.5em;
            font-weight: bold;
            color: #495057;
        }

        .phase-container {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s;
        }

        .phase-container.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .section h2 {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 3px solid #f093fb;
            padding-bottom: 10px;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .product-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            transition: all 0.3s;
        }

        .product-card:hover {
            border-color: #f093fb;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.3);
        }

        .product-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .product-icon {
            font-size: 3em;
        }

        .product-info h3 {
            font-size: 1.3em;
            color: #495057;
            margin-bottom: 5px;
        }

        .product-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.75em;
            font-weight: bold;
            margin-top: 5px;
        }

        .badge-high {
            background: #d4edda;
            color: #155724;
        }

        .badge-medium {
            background: #fff3cd;
            color: #856404;
        }

        .badge-low {
            background: #f8d7da;
            color: #721c24;
        }

        .product-details {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .detail-label {
            color: #6c757d;
        }

        .detail-value {
            font-weight: bold;
            color: #495057;
        }

        .bulk-discount {
            background: #d1ecf1;
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #0c5460;
            text-align: center;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        .quantity-label {
            font-weight: bold;
            color: #495057;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .qty-btn {
            background: #f093fb;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .qty-btn:hover {
            background: #e082ea;
            transform: scale(1.1);
        }

        .qty-btn:active {
            transform: scale(0.95);
        }

        .qty-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
        }

        .cost-display {
            text-align: center;
            padding: 10px;
            background: #e7f3ff;
            border-radius: 8px;
            margin-top: 10px;
        }

        .cost-display .label {
            font-size: 0.85em;
            color: #6c757d;
        }

        .cost-display .value {
            font-size: 1.3em;
            font-weight: bold;
            color: #0066cc;
        }

        .budget-summary {
            background: white;
            padding: 25px;
            border-radius: 15px;
            position: sticky;
            top: 20px;
        }

        .budget-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .budget-amount {
            font-size: 2.5em;
            font-weight: bold;
            color: #28a745;
        }

        .budget-progress {
            background: #e9ecef;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }

        .budget-bar {
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
            height: 100%;
            transition: all 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .budget-bar.warning {
            background: linear-gradient(90deg, #ffc107 0%, #ff9800 100%);
        }

        .budget-bar.danger {
            background: linear-gradient(90deg, #dc3545 0%, #c82333 100%);
        }

        .cart-items {
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .cart-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-item-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cart-item-icon {
            font-size: 1.5em;
        }

        .location-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .location-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 3px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .location-card:hover {
            border-color: #f093fb;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(240, 147, 251, 0.3);
        }

        .location-card.selected {
            border-color: #f093fb;
            background: linear-gradient(135deg, #fef5ff 0%, #fff0f8 100%);
        }

        .location-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .location-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #495057;
            margin-bottom: 10px;
        }

        .location-cost {
            font-size: 1.5em;
            color: #28a745;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .location-stats {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .location-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
        }

        .pricing-container {
            margin-top: 20px;
        }

        .week-pricing {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 2px solid #e9ecef;
        }

        .week-pricing h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #495057;
        }

        .pricing-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .pricing-btn {
            padding: 15px;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .pricing-btn:hover {
            border-color: #f093fb;
            transform: translateY(-2px);
        }

        .pricing-btn.selected {
            border-color: #f093fb;
            background: #fef5ff;
            font-weight: bold;
        }

        .pricing-label {
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .pricing-value {
            font-size: 0.9em;
            color: #6c757d;
        }

        .marketing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .marketing-option {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s;
        }

        .marketing-option:hover {
            border-color: #f093fb;
        }

        .marketing-option.selected {
            border-color: #f093fb;
            background: #fef5ff;
        }

        .marketing-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .marketing-icon {
            font-size: 2em;
        }

        .marketing-name {
            font-weight: bold;
            font-size: 1.1em;
        }

        .marketing-cost {
            color: #28a745;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .marketing-reach {
            font-size: 0.9em;
            color: #6c757d;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }

        .sales-day {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-right: 5px solid #f093fb;
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .day-title {
            font-size: 1.5em;
            font-weight: bold;
            color: #495057;
        }

        .day-stats {
            display: flex;
            gap: 20px;
        }

        .day-stat {
            text-align: center;
        }

        .day-stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #f093fb;
        }

        .day-stat-label {
            font-size: 0.9em;
            color: #6c757d;
        }

        .customer-activity {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .customer {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .customer-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .customer-avatar {
            font-size: 2.5em;
        }

        .customer-purchase {
            font-size: 0.9em;
            color: #6c757d;
        }

        .customer-spent {
            font-size: 1.3em;
            font-weight: bold;
            color: #28a745;
        }

        .inventory-alert {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            border-right: 4px solid #ffc107;
            margin-bottom: 15px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s;
        }

        @keyframes modalSlide {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .modal-header h2 {
            font-size: 2.5em;
            color: #495057;
            margin-bottom: 10px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .result-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .result-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 2em;
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }

        .result-label {
            color: #6c757d;
            font-size: 0.9em;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 200px;
            gap: 10px;
            margin-top: 20px;
        }

        .bar {
            flex: 1;
            background: linear-gradient(180deg, #f093fb 0%, #f5576c 100%);
            border-radius: 8px 8px 0 0;
            position: relative;
            transition: all 0.5s;
            min-height: 20px;
        }

        .bar-label {
            position: absolute;
            bottom: -30px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.9em;
            color: #6c757d;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-weight: bold;
            color: #495057;
        }

        .insights-list {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .insight-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-right: 4px solid #28a745;
        }

        .insight-item.warning {
            border-right-color: #ffc107;
        }

        .insight-item.danger {
            border-right-color: #dc3545;
        }

        @media (max-width: 768px) {
            .product-grid,
            .location-grid,
            .pricing-options,
            .marketing-grid {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }

            .header h1 {
                font-size: 1.8em;
            }

            .budget-summary {
                position: static;
                margin-top: 20px;
            }
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .progress-indicator {
            text-align: center;
            padding: 20px;
            font-size: 1.1em;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’ Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</h1>
            <p>Ù…ÙˆØ³Ù… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø¯Ø§Ø±Ø³ - 4 Ø£Ø³Ø§Ø¨ÙŠØ¹ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‚ØµÙ‰ Ø±Ø¨Ø­!</p>
            <div class="week-indicator">
                <div class="week-badge active" id="weekBadge1">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 1: Ø§Ù„ØªØ­Ø¶ÙŠØ±</div>
                <div class="week-badge" id="weekBadge2">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 2: Ø§Ù„Ø°Ø±ÙˆØ©</div>
                <div class="week-badge" id="weekBadge3">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 3: Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…</div>
                <div class="week-badge" id="weekBadge4">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 4: Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…ÙˆØ³Ù…</div>
            </div>
        </div>

        <div class="stats-bar">
            <div class="stat-card">
                <div class="icon">ğŸ’µ</div>
                <div class="label">Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„</div>
                <div class="value" id="money">$300.00</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“¦</div>
                <div class="label">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</div>
                <div class="value" id="inventory">0</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                <div class="value" id="revenue">$0.00</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="label">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ</div>
                <div class="value" id="profit">$0.00</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ›’</div>
                <div class="label">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div>
                <div class="value" id="sales">0</div>
            </div>
        </div>

        <!-- Phase 1: Product Selection -->
        <div class="phase-container active" id="phase1">
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 25px;">
                <div>
                    <div class="section">
                        <h2>ğŸ›ï¸ Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ø§ØªÙƒ</h2>
                        <p style="color: #6c757d; margin-bottom: 20px;">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø´Ø±Ø§Ø¡Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ù…Ù„Ø©. ØªØ°ÙƒØ±: Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨ÙƒÙ…ÙŠØ§Øª ÙƒØ¨ÙŠØ±Ø© ÙŠÙˆÙØ± Ø§Ù„Ù…Ø§Ù„!</p>
                        
                        <div class="product-grid" id="productGrid"></div>
                    </div>
                </div>

                <div>
                    <div class="budget-summary">
                        <div class="budget-header">
                            <h3>ğŸ’¼ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</h3>
                            <div class="budget-amount" id="budgetDisplay">$300.00</div>
                        </div>
                        
                        <div class="budget-progress">
                            <div class="budget-bar" id="budgetBar" style="width: 100%">Ù…ØªØ¨Ù‚ÙŠ 100%</div>
                        </div>

                        <div class="cart-items" id="cartItems">
                            <p style="text-align: center; color: #6c757d; padding: 20px;">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø±Ø¤ÙŠØ© Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</p>
                        </div>

                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-top: 20px;">
                            <div class="detail-row">
                                <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒÙ„ÙØ©:</span>
                                <strong id="totalCost">$0.00</strong>
                            </div>
                            <div class="detail-row">
                                <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</span>
                                <strong id="totalItems">0</strong>
                            </div>
                            <div class="detail-row">
                                <span>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</span>
                                <strong id="remaining">$300.00</strong>
                            </div>
                        </div>

                        <div class="action-buttons" style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="completeInventory()" id="continueBtn1">Ù…ØªØ§Ø¨Ø¹Ø© â†</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 2: Location Selection -->
        <div class="phase-container" id="phase2">
            <div class="section">
                <h2>ğŸ“ Ø§Ø®ØªØ± Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØªØ¬Ø±</h2>
                <p style="color: #6c757d; margin-bottom: 20px;">Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† ÙˆØªÙƒØ§Ù„ÙŠÙÙƒ Ø§Ù„Ø«Ø§Ø¨ØªØ©</p>
                
                <div class="location-grid" id="locationGrid"></div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="goToPhase(1)">â†’ Ø±Ø¬ÙˆØ¹</button>
                <button class="btn btn-primary" onclick="completeLocation()" id="continueBtn2">Ù…ØªØ§Ø¨Ø¹Ø© â†</button>
            </div>
        </div>

        <!-- Phase 3: Pricing Strategy -->
        <div class="phase-container" id="phase3">
            <div class="section">
                <h2>ğŸ’µ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ³Ø¹ÙŠØ±</h2>
                <p style="color: #6c757d; margin-bottom: 20px;">Ø­Ø¯Ø¯ Ø£Ø³Ø¹Ø§Ø±Ùƒ Ù„ÙƒÙ„ Ø£Ø³Ø¨ÙˆØ¹. ØªØ°ÙƒØ±: Ø§Ù„Ø·Ù„Ø¨ ÙŠØªØºÙŠØ± Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª!</p>
                
                <div class="pricing-container" id="pricingContainer"></div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="goToPhase(2)">â†’ Ø±Ø¬ÙˆØ¹</button>
                <button class="btn btn-primary" onclick="completePricing()">Ù…ØªØ§Ø¨Ø¹Ø© â†</button>
            </div>
        </div>

        <!-- Phase 4: Marketing -->
        <div class="phase-container" id="phase4">
            <div class="section">
                <h2>ğŸ“¢ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ³ÙˆÙŠÙ‚</h2>
                <p style="color: #6c757d; margin-bottom: 20px;">ÙƒÙŠÙ Ø³ØªØ¬Ø°Ø¨ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†ØŸ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø© Ø®ÙŠØ§Ø±Ø§Øª</p>
                
                <div class="marketing-grid" id="marketingGrid"></div>

                <div style="background: white; padding: 20px; border-radius: 12px; margin-top: 20px;">
                    <div class="detail-row">
                        <span>ØªÙƒÙ„ÙØ© Ø§Ù„ØªØ³ÙˆÙŠÙ‚:</span>
                        <strong id="marketingCost">$0.00</strong>
                    </div>
                    <div class="detail-row">
                        <span>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³ÙˆÙŠÙ‚:</span>
                        <strong id="afterMarketing">$300.00</strong>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="goToPhase(3)">â†’ Ø±Ø¬ÙˆØ¹</button>
                <button class="btn btn-primary" onclick="startSelling()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨ÙŠØ¹!</button>
            </div>
        </div>

        <!-- Phase 5: Sales Simulation -->
        <div class="phase-container" id="phase5">
            <div id="salesContainer"></div>
        </div>

        <!-- Phase 6: Results -->
        <div class="phase-container" id="phase6">
            <div id="resultsContainer"></div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal" id="resultsModal">
        <div class="modal-content" id="modalContent"></div>
    </div>

    <script>
        const products = [
            {
                id: 'notebooks',
                name: 'Ø¯ÙØ§ØªØ±',
                icon: 'ğŸ““',
                wholesale: 0.50,
                bulkPrice: 0.40,
                bulkMin: 100,
                minOrder: 20,
                retail: 2.50,
                demand: 'high',
                competition: 'heavy',
                margin: 'low'
            },
            {
                id: 'pencils',
                name: 'Ø¹Ù„Ø¨ Ø£Ù‚Ù„Ø§Ù… Ø±ØµØ§Øµ',
                icon: 'âœï¸',
                wholesale: 1.00,
                bulkPrice: 0.80,
                bulkMin: 50,
                minOrder: 10,
                retail: 4.00,
                demand: 'high',
                competition: 'heavy',
                margin: 'medium'
            },
            {
                id: 'backpacks',
                name: 'Ø­Ù‚Ø§Ø¦Ø¨ Ù…Ø¯Ø±Ø³ÙŠØ©',
                icon: 'ğŸ’',
                wholesale: 12.00,
                bulkPrice: 10.00,
                bulkMin: 20,
                minOrder: 5,
                retail: 40.00,
                demand: 'high',
                competition: 'moderate',
                margin: 'good'
            },
            {
                id: 'calculators',
                name: 'Ø¢Ù„Ø§Øª Ø­Ø§Ø³Ø¨Ø© Ø¹Ù„Ù…ÙŠØ©',
                icon: 'ğŸ”¢',
                wholesale: 15.00,
                bulkPrice: 12.00,
                bulkMin: 15,
                minOrder: 3,
                retail: 45.00,
                demand: 'medium',
                competition: 'low',
                margin: 'high'
            },
            {
                id: 'markers',
                name: 'Ø£Ù‚Ù„Ø§Ù… ØªÙ„ÙˆÙŠÙ†',
                icon: 'ğŸ–ï¸',
                wholesale: 3.00,
                bulkPrice: 2.50,
                bulkMin: 30,
                minOrder: 10,
                retail: 10.00,
                demand: 'medium',
                competition: 'moderate',
                margin: 'medium'
            },
            {
                id: 'binders',
                name: 'Ù…Ø¬Ù„Ø¯Ø§Øª ÙØ§Ø®Ø±Ø©',
                icon: 'ğŸ“š',
                wholesale: 4.00,
                bulkPrice: 3.20,
                bulkMin: 40,
                minOrder: 10,
                retail: 12.00,
                demand: 'medium',
                competition: 'low',
                margin: 'good'
            },
            {
                id: 'sticky',
                name: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ø§ØµÙ‚Ø©',
                icon: 'ğŸ“',
                wholesale: 0.75,
                bulkPrice: 0.60,
                bulkMin: 50,
                minOrder: 15,
                retail: 3.50,
                demand: 'low',
                competition: 'heavy',
                margin: 'low'
            }
        ];

        const locations = [
            {
                id: 'home',
                name: 'Ø¨ÙŠØ¹ Ù…Ù†Ø²Ù„ÙŠ',
                icon: 'ğŸ ',
                cost: 0,
                customers: [20, 30],
                legitimacy: 0.7,
                hours: 'unlimited'
            },
            {
                id: 'community',
                name: 'Ø·Ø§ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ÙŠ',
                icon: 'ğŸ¢',
                cost: 60,
                customers: [60, 100],
                legitimacy: 0.85,
                hours: '10am-6pm'
            },
            {
                id: 'school',
                name: 'ÙƒØ´Ùƒ ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©',
                icon: 'ğŸ«',
                cost: 80,
                customers: [150, 250],
                legitimacy: 1.0,
                hours: 'weekend',
                weekOnly: 2
            },
            {
                id: 'mall',
                name: 'Ù…ØªØ¬Ø± Ù…Ø¤Ù‚Øª ÙÙŠ Ø§Ù„Ù…ÙˆÙ„',
                icon: 'ğŸ¬',
                cost: 200,
                customers: [100, 150],
                legitimacy: 0.95,
                hours: 'full'
            }
        ];

        const marketingOptions = [
            {
                id: 'social',
                name: 'Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„',
                icon: 'ğŸ“±',
                cost: 20,
                reach: 500
            },
            {
                id: 'school',
                name: 'Ø´Ø±Ø§ÙƒØ© Ù…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©',
                icon: 'ğŸ¤',
                cost: 30,
                reach: 'endorsement'
            },
            {
                id: 'flyers',
                name: 'Ù…Ù†Ø´ÙˆØ±Ø§Øª ÙˆÙ…Ù„ØµÙ‚Ø§Øª',
                icon: 'ğŸ“°',
                cost: 15,
                reach: 300
            },
            {
                id: 'event',
                name: 'Ø­ÙÙ„ Ø§ÙØªØªØ§Ø­',
                icon: 'ğŸ‰',
                cost: 40,
                reach: 'buzz'
            }
        ];

        const gameState = {
            currentPhase: 1,
            money: 300,
            initialMoney: 300,
            inventory: {},
            location: null,
            pricing: {
                week2: {},
                week3: {},
                week4: {}
            },
            marketing: [],
            sales: {
                week2: [],
                week3: [],
                week4: []
            },
            revenue: 0,
            expenses: 0,
            profit: 0,
            totalSold: 0
        };

        function initProducts() {
            const grid = document.getElementById('productGrid');
            products.forEach(product => {
                const card = createProductCard(product);
                grid.appendChild(card);
            });
        }

        function createProductCard(product) {
            const demandBadge = product.demand === 'high' ? 'badge-high' : product.demand === 'medium' ? 'badge-medium' : 'badge-low';
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <div class="product-header">
                    <div class="product-icon">${product.icon}</div>
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <span class="product-badge ${demandBadge}">Ø·Ù„Ø¨ ${product.demand === 'high' ? 'Ù…Ø±ØªÙØ¹' : product.demand === 'medium' ? 'Ù…ØªÙˆØ³Ø·' : 'Ù…Ù†Ø®ÙØ¶'}</span>
                    </div>
                </div>
                <div class="product-details">
                    <div class="detail-row">
                        <span class="detail-label">Ø³Ø¹Ø± Ø§Ù„Ø¬Ù…Ù„Ø©:</span>
                        <span class="detail-value">$${product.wholesale.toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰:</span>
                        <span class="detail-value">${product.minOrder} ÙˆØ­Ø¯Ø©</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­:</span>
                        <span class="detail-value">$${product.retail.toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©:</span>
                        <span class="detail-value">${product.competition === 'heavy' ? 'Ù‚ÙˆÙŠØ©' : product.competition === 'moderate' ? 'Ù…ØªÙˆØ³Ø·Ø©' : 'Ø¶Ø¹ÙŠÙØ©'}</span>
                    </div>
                </div>
                <div class="bulk-discount">
                    ğŸ’° Ø®ØµÙ… Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ø§Ù„Ø¬Ù…Ù„Ø©: ${product.bulkMin}+ ÙˆØ­Ø¯Ø© = $${product.bulkPrice.toFixed(2)}/ÙˆØ­Ø¯Ø©
                </div>
                <div class="quantity-selector">
                    <span class="quantity-label">Ø§Ù„ÙƒÙ…ÙŠØ©:</span>
                    <div class="quantity-controls">
                        <button class="qty-btn" onclick="changeQuantity('${product.id}', -${product.minOrder})">-</button>
                        <input type="number" class="qty-input" id="qty_${product.id}" value="0" min="0" step="${product.minOrder}" onchange="updateQuantity('${product.id}')">
                        <button class="qty-btn" onclick="changeQuantity('${product.id}', ${product.minOrder})">+</button>
                    </div>
                </div>
                <div class="cost-display">
                    <div class="label">Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</div>
                    <div class="value" id="cost_${product.id}">$0.00</div>
                </div>
            `;
            return card;
        }

        function changeQuantity(productId, delta) {
            const input = document.getElementById(`qty_${productId}`);
            const currentQty = parseInt(input.value) || 0;
            const newQty = Math.max(0, currentQty + delta);
            input.value = newQty;
            updateQuantity(productId);
        }

        function updateQuantity(productId) {
            const input = document.getElementById(`qty_${productId}`);
            const qty = parseInt(input.value) || 0;
            const product = products.find(p => p.id === productId);
            
            if (qty > 0 && qty < product.minOrder) {
                input.value = product.minOrder;
                return updateQuantity(productId);
            }

            const price = qty >= product.bulkMin ? product.bulkPrice : product.wholesale;
            const cost = qty * price;

            document.getElementById(`cost_${productId}`).textContent = `$${cost.toFixed(2)}`;
            
            if (qty > 0) {
                gameState.inventory[productId] = {
                    quantity: qty,
                    cost: cost,
                    unitCost: price
                };
            } else {
                delete gameState.inventory[productId];
            }

            updateBudgetDisplay();
        }

        function updateBudgetDisplay() {
            const totalCost = Object.values(gameState.inventory).reduce((sum, item) => sum + item.cost, 0);
            const totalItems = Object.values(gameState.inventory).reduce((sum, item) => sum + item.quantity, 0);
            const remaining = gameState.money - totalCost;
            const percentage = (remaining / gameState.money) * 100;

            document.getElementById('totalCost').textContent = `$${totalCost.toFixed(2)}`;
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('remaining').textContent = `$${remaining.toFixed(2)}`;
            
            const budgetBar = document.getElementById('budgetBar');
            budgetBar.style.width = `${percentage}%`;
            budgetBar.textContent = `Ù…ØªØ¨Ù‚ÙŠ ${percentage.toFixed(0)}%`;
            
            budgetBar.className = 'budget-bar';
            if (percentage < 50) budgetBar.classList.add('warning');
            if (percentage < 20) budgetBar.classList.add('danger');

            updateCart();
        }

        function updateCart() {
            const container = document.getElementById('cartItems');
            if (Object.keys(gameState.inventory).length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø±Ø¤ÙŠØ© Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</p>';
                return;
            }

            container.innerHTML = '';
            Object.keys(gameState.inventory).forEach(productId => {
                const product = products.find(p => p.id === productId);
                const item = gameState.inventory[productId];
                const div = document.createElement('div');
                div.className = 'cart-item';
                div.innerHTML = `
                    <div class="cart-item-info">
                        <span class="cart-item-icon">${product.icon}</span>
                        <div>
                            <div style="font-weight: bold;">${product.name}</div>
                            <div style="font-size: 0.85em; color: #6c757d;">${item.quantity} Ã— $${item.unitCost.toFixed(2)}</div>
                        </div>
                    </div>
                    <div style="font-weight: bold; color: #28a745;">$${item.cost.toFixed(2)}</div>
                `;
                container.appendChild(div);
            });
        }

        function completeInventory() {
            const totalCost = Object.values(gameState.inventory).reduce((sum, item) => sum + item.cost, 0);
            if (totalCost > gameState.money) {
                alert('Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø´Ø±Ø§Ø¡ Ø£ÙƒØ«Ø± Ù…Ù† Ù…ÙŠØ²Ø§Ù†ÙŠØªÙƒ!');
                return;
            }
            if (Object.keys(gameState.inventory).length === 0) {
                alert('ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†ØªØ¬ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„!');
                return;
            }

            gameState.money -= totalCost;
            gameState.expenses += totalCost;
            goToPhase(2);
            initLocations();
        }

        function initLocations() {
            const grid = document.getElementById('locationGrid');
            grid.innerHTML = '';
            locations.forEach(location => {
                const card = createLocationCard(location);
                grid.appendChild(card);
            });
        }

        function createLocationCard(location) {
            const card = document.createElement('div');
            card.className = 'location-card';
            card.onclick = () => selectLocation(location.id);
            card.innerHTML = `
                <div class="location-icon">${location.icon}</div>
                <div class="location-name">${location.name}</div>
                <div class="location-cost">${location.cost === 0 ? 'Ù…Ø¬Ø§Ù†ÙŠ' : '$' + location.cost.toFixed(2)}</div>
                <div class="location-stats">
                    <div class="location-stat">
                        <span>Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†:</span>
                        <strong>${location.customers[0]}-${location.customers[1]} Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹</strong>
                    </div>
                    <div class="location-stat">
                        <span>Ø§Ù„Ù…ØµØ¯Ø§Ù‚ÙŠØ©:</span>
                        <strong>${(location.legitimacy * 100).toFixed(0)}%</strong>
                    </div>
                    <div class="location-stat">
                        <span>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„:</span>
                        <strong>${location.hours === 'unlimited' ? 'Ø¨Ø¯ÙˆÙ† Ù‚ÙŠÙˆØ¯' : location.hours === 'weekend' ? 'Ø¹Ø·Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹' : location.hours === 'full' ? 'Ø·ÙˆØ§Ù„ Ø§Ù„ÙŠÙˆÙ…' : location.hours}</strong>
                    </div>
                </div>
            `;
            return card;
        }

        function selectLocation(locationId) {
            document.querySelectorAll('.location-card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            gameState.location = locations.find(l => l.id === locationId);
        }

        function completeLocation() {
            if (!gameState.location) {
                alert('ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ø®ØªÙŠØ§Ø± Ù…ÙˆÙ‚Ø¹!');
                return;
            }

            if (gameState.location.cost > gameState.money) {
                alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù…Ø§Ù„ ÙƒØ§ÙÙ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹!');
                return;
            }

            gameState.money -= gameState.location.cost;
            gameState.expenses += gameState.location.cost;
            goToPhase(3);
            initPricing();
        }

        function initPricing() {
            const container = document.getElementById('pricingContainer');
            container.innerHTML = '';

            const weeks = [
                { id: 'week2', name: 'Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 2', desc: 'Ø°Ø±ÙˆØ© Ø§Ù„Ø·Ù„Ø¨ - Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† Ù…Ø³ØªØ¹Ø¬Ù„ÙˆÙ†', icon: 'ğŸ“ˆ' },
                { id: 'week3', name: 'Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 3', desc: 'Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù… - Ø§Ù„Ø·Ù„Ø¨ ÙŠØªØ±Ø§Ø¬Ø¹', icon: 'ğŸ“Š' },
                { id: 'week4', name: 'Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 4', desc: 'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…ÙˆØ³Ù… - ØªØµÙÙŠØ©', icon: 'ğŸ“‰' }
            ];

            weeks.forEach(week => {
                const div = document.createElement('div');
                div.className = 'week-pricing';
                div.innerHTML = `
                    <h3>${week.icon} ${week.name}</h3>
                    <p style="color: #6c757d; margin-bottom: 15px;">${week.desc}</p>
                    <div class="pricing-options" id="pricing_${week.id}"></div>
                `;
                container.appendChild(div);

                const pricingOptions = [
                    { id: 'premium', label: 'ÙØ§Ø®Ø±', modifier: 1.2 },
                    { id: 'market', label: 'Ø³ÙˆÙ‚ÙŠ', modifier: 1.0 },
                    { id: 'discount', label: 'Ø®ØµÙ…', modifier: 0.85 },
                    { id: 'clearance', label: 'ØªØµÙÙŠØ©', modifier: 0.6 }
                ];

                const optionsContainer = document.getElementById(`pricing_${week.id}`);
                pricingOptions.forEach(option => {
                    const btn = document.createElement('div');
                    btn.className = 'pricing-btn';
                    if (option.id === 'market') btn.classList.add('selected');
                    btn.onclick = () => selectPricing(week.id, option.id);
                    btn.innerHTML = `
                        <div class="pricing-label">${option.label}</div>
                        <div class="pricing-value">${option.modifier > 1 ? '+' : ''}${((option.modifier - 1) * 100).toFixed(0)}%</div>
                    `;
                    optionsContainer.appendChild(btn);
                });

                gameState.pricing[week.id] = 'market';
            });
        }

        function selectPricing(week, pricingId) {
            document.querySelectorAll(`#pricing_${week} .pricing-btn`).forEach(b => b.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            gameState.pricing[week] = pricingId;
        }

        function completePricing() {
            goToPhase(4);
            initMarketing();
        }

        function initMarketing() {
            const grid = document.getElementById('marketingGrid');
            grid.innerHTML = '';
            
            marketingOptions.forEach(option => {
                const card = createMarketingCard(option);
                grid.appendChild(card);
            });

            updateMarketingCost();
        }

        function createMarketingCard(option) {
            const card = document.createElement('div');
            card.className = 'marketing-option';
            card.onclick = () => toggleMarketing(option.id);
            card.innerHTML = `
                <div class="marketing-header">
                    <div class="marketing-icon">${option.icon}</div>
                    <div class="marketing-name">${option.name}</div>
                </div>
                <div class="marketing-cost">$${option.cost.toFixed(2)}</div>
                <div class="marketing-reach">
                    ${typeof option.reach === 'number' ? `ÙŠØµÙ„ Ø¥Ù„Ù‰ ${option.reach}+ Ø´Ø®Øµ` : option.reach === 'endorsement' ? 'ØªÙˆØµÙŠØ© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©' : 'ÙŠÙ†Ø´Ø¦ Ø¶Ø¬Ø©'}
                </div>
            `;
            return card;
        }

        function toggleMarketing(marketingId) {
            const index = gameState.marketing.indexOf(marketingId);
            if (index > -1) {
                gameState.marketing.splice(index, 1);
                event.currentTarget.classList.remove('selected');
            } else {
                const option = marketingOptions.find(m => m.id === marketingId);
                const totalCost = gameState.marketing.reduce((sum, m) => {
                    return sum + marketingOptions.find(opt => opt.id === m).cost;
                }, 0) + option.cost;

                if (totalCost <= gameState.money) {
                    gameState.marketing.push(marketingId);
                    event.currentTarget.classList.add('selected');
                } else {
                    alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù…Ø§Ù„ ÙƒØ§ÙÙ!');
                }
            }
            updateMarketingCost();
        }

        function updateMarketingCost() {
            const cost = gameState.marketing.reduce((sum, m) => {
                return sum + marketingOptions.find(opt => opt.id === m).cost;
            }, 0);
            
            document.getElementById('marketingCost').textContent = `$${cost.toFixed(2)}`;
            document.getElementById('afterMarketing').textContent = `$${(gameState.money - cost).toFixed(2)}`;
        }

        function startSelling() {
            const marketingCost = gameState.marketing.reduce((sum, m) => {
                return sum + marketingOptions.find(opt => opt.id === m).cost;
            }, 0);
            
            gameState.money -= marketingCost;
            gameState.expenses += marketingCost;
            
            goToPhase(5);
            simulateWeek(2);
        }

        function simulateWeek(weekNum) {
            updateWeekBadge(weekNum);
            const container = document.getElementById('salesContainer');
            container.innerHTML = `
                <div class="section">
                    <h2>ğŸ›’ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${weekNum} - ${weekNum === 2 ? 'Ø°Ø±ÙˆØ© Ø§Ù„Ù…ÙˆØ³Ù…' : weekNum === 3 ? 'Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…' : 'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…ÙˆØ³Ù…'}</h2>
                    <div class="progress-indicator">
                        <div class="loading-spinner"></div>
                        <p style="margin-top: 15px;">Ø¬Ø§Ø±ÙŠ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª...</p>
                    </div>
                </div>
            `;

            setTimeout(() => {
                runWeekSimulation(weekNum);
            }, 2000);
        }

        function runWeekSimulation(weekNum) {
            const weekKey = `week${weekNum}`;
            const baseCustomers = gameState.location.customers[0] + 
                Math.random() * (gameState.location.customers[1] - gameState.location.customers[0]);
            
            let customerMultiplier = 1.0;
            if (weekNum === 2) customerMultiplier = 1.5;
            if (weekNum === 3) customerMultiplier = 0.6;
            if (weekNum === 4) customerMultiplier = 0.25;

            gameState.marketing.forEach(m => {
                const option = marketingOptions.find(opt => opt.id === m);
                if (typeof option.reach === 'number') {
                    customerMultiplier += 0.2;
                } else {
                    customerMultiplier += 0.3;
                }
            });

            const totalCustomers = Math.floor(baseCustomers * customerMultiplier);
            const pricing = gameState.pricing[weekKey];
            const pricingModifier = {
                'premium': 1.2,
                'market': 1.0,
                'discount': 0.85,
                'clearance': 0.6
            }[pricing];

            let weekRevenue = 0;
            const salesLog = [];

            for (let i = 0; i < totalCustomers; i++) {
                const budget = 10 + Math.random() * 70;
                const purchase = simulateCustomerPurchase(budget, pricingModifier, weekNum);
                
                if (purchase.revenue > 0) {
                    weekRevenue += purchase.revenue;
                    salesLog.push(purchase);
                }
            }

            gameState.sales[weekKey] = salesLog;
            gameState.revenue += weekRevenue;
            gameState.money += weekRevenue;

            displayWeekResults(weekNum, totalCustomers, weekRevenue, salesLog);
        }

        function simulateCustomerPurchase(budget, priceModifier, weekNum) {
            const items = [];
            let spent = 0;

            Object.keys(gameState.inventory).forEach(productId => {
                const product = products.find(p => p.id === productId);
                const stock = gameState.inventory[productId].quantity;
                
                if (stock <= 0) return;

                const price = product.retail * priceModifier;
                const demandProb = {
                    'notebooks': 0.9,
                    'pencils': 0.85,
                    'backpacks': 0.7,
                    'calculators': 0.4,
                    'markers': 0.5,
                    'binders': 0.6,
                    'sticky': 0.3
                }[productId];

                let purchaseProb = demandProb;
                if (priceModifier > 1.1) purchaseProb *= 0.7;
                if (priceModifier < 0.9) purchaseProb *= 1.2;
                
                purchaseProb *= gameState.location.legitimacy;

                if (Math.random() < purchaseProb && spent + price <= budget) {
                    const qty = productId === 'notebooks' || productId === 'pencils' ? Math.floor(1 + Math.random() * 3) : 1;
                    const actualQty = Math.min(qty, stock);
                    
                    items.push({
                        product: product.name,
                        icon: product.icon,
                        quantity: actualQty,
                        price: price,
                        total: price * actualQty
                    });
                    
                    spent += price * actualQty;
                    gameState.inventory[productId].quantity -= actualQty;
                    gameState.totalSold += actualQty;
                }
            });

            return {
                items: items,
                revenue: spent
            };
        }

        function displayWeekResults(weekNum, customers, revenue, sales) {
            const container = document.getElementById('salesContainer');
            const successfulSales = sales.filter(s => s.revenue > 0).length;
            
            container.innerHTML = `
                <div class="section">
                    <h2>ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${weekNum}</h2>
                    
                    <div class="result-grid">
                        <div class="result-card">
                            <div class="result-icon">ğŸ‘¥</div>
                            <div class="result-value">${customers}</div>
                            <div class="result-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø²ÙˆØ§Ø±</div>
                        </div>
                        <div class="result-card">
                            <div class="result-icon">ğŸ›’</div>
                            <div class="result-value">${successfulSales}</div>
                            <div class="result-label">Ø¹Ù…Ù„ÙŠØ§Øª Ø´Ø±Ø§Ø¡</div>
                        </div>
                        <div class="result-card">
                            <div class="result-icon">ğŸ’°</div>
                            <div class="result-value">$${revenue.toFixed(2)}</div>
                            <div class="result-label">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                        </div>
                        <div class="result-card">
                            <div class="result-icon">ğŸ“¦</div>
                            <div class="result-value">${Object.values(gameState.inventory).reduce((sum, i) => sum + i.quantity, 0)}</div>
                            <div class="result-label">Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
                        </div>
                    </div>

                    ${weekNum < 4 ? `
                        <div class="action-buttons" style="margin-top: 30px;">
                            <button class="btn btn-primary" onclick="simulateWeek(${weekNum + 1})">Ø§Ù„ØªØ§Ù„ÙŠ: Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${weekNum + 1} â†</button>
                        </div>
                    ` : `
                        <div class="action-buttons" style="margin-top: 30px;">
                            <button class="btn btn-primary" onclick="showFinalResults()">ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</button>
                        </div>
                    `}
                </div>
            `;

            updateStats();
        }

        function showFinalResults() {
            goToPhase(6);
            
            const profit = gameState.revenue - gameState.expenses;
            const roi = ((profit / gameState.initialMoney) * 100).toFixed(1);
            const sellThrough = ((gameState.totalSold / Object.values(gameState.inventory).reduce((sum, i) => sum + i.quantity + gameState.totalSold, 0)) * 100).toFixed(1);

            const container = document.getElementById('resultsContainer');
            container.innerHTML = `
                <div class="modal-header">
                    <h2>ğŸ‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h2>
                    <p style="color: #6c757d;">Ù…ÙˆØ³Ù… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø¯Ø§Ø±Ø³ Ù…ÙƒØªÙ…Ù„!</p>
                </div>

                <div class="result-grid">
                    <div class="result-card">
                        <div class="result-icon">ğŸ’µ</div>
                        <div class="result-value">$${gameState.revenue.toFixed(2)}</div>
                        <div class="result-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                    </div>
                    <div class="result-card">
                        <div class="result-icon">ğŸ’¸</div>
                        <div class="result-value">$${gameState.expenses.toFixed(2)}</div>
                        <div class="result-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                    </div>
                    <div class="result-card">
                        <div class="result-icon">${profit >= 0 ? 'ğŸ’°' : 'ğŸ“‰'}</div>
                        <div class="result-value" style="color: ${profit >= 0 ? '#28a745' : '#dc3545'}">$${profit.toFixed(2)}</div>
                        <div class="result-label">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ</div>
                    </div>
                    <div class="result-card">
                        <div class="result-icon">ğŸ“ˆ</div>
                        <div class="result-value">${roi}%</div>
                        <div class="result-label">Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</div>
                    </div>
                </div>

                <div class="chart-container">
                    <h3 style="margin-bottom: 20px;">ğŸ“Š Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</h3>
                    <div class="bar-chart">
                        ${[2, 3, 4].map(week => {
                            const weekRevenue = gameState.sales[`week${week}`].reduce((sum, s) => sum + s.revenue, 0);
                            const maxRevenue = Math.max(...[2, 3, 4].map(w => 
                                gameState.sales[`week${w}`].reduce((sum, s) => sum + s.revenue, 0)
                            ));
                            const height = (weekRevenue / maxRevenue) * 100;
                            return `
                                <div class="bar" style="height: ${height}%">
                                    <div class="bar-value">$${weekRevenue.toFixed(0)}</div>
                                    <div class="bar-label">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${week}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>

                <div class="insights-list">
                    <h3 style="margin-bottom: 15px;">ğŸ’¡ Ø±Ø¤Ù‰ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©</h3>
                    ${generateInsights(profit, roi, sellThrough)}
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="location.reload()">ğŸ”„ Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
                </div>
            `;
        }

        function generateInsights(profit, roi, sellThrough) {
            const insights = [];

            if (profit >= 400) {
                insights.push('<div class="insight-item">ğŸŒŸ Ù…Ù…ØªØ§Ø²! Ø­Ù‚Ù‚Øª Ø±Ø¨Ø­Ø§Ù‹ Ù…Ø°Ù‡Ù„Ø§Ù‹. Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØªÙƒ ÙƒØ§Ù†Øª ÙØ¹Ø§Ù„Ø© Ø¬Ø¯Ø§Ù‹!</div>');
            } else if (profit >= 200) {
                insights.push('<div class="insight-item">âœ… Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! Ø±Ø¨Ø­ Ù‚ÙˆÙŠ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ù‚Ø±Ø§Ø±Ø§Øª Ø°ÙƒÙŠØ©.</div>');
            } else if (profit >= 0) {
                insights.push('<div class="insight-item warning">âš ï¸ Ø±Ø¨Ø­ Ù…ØªÙˆØ§Ø¶Ø¹. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø³ÙŠÙ† Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ³Ø¹ÙŠØ± ÙˆØ§Ù„ØªØ³ÙˆÙŠÙ‚.</div>');
            } else {
                insights.push('<div class="insight-item danger">âŒ Ø®Ø³Ø§Ø±Ø©! Ø±Ø§Ø¬Ø¹ Ù‚Ø±Ø§Ø±Ø§ØªÙƒ Ø¨Ø´Ø£Ù† Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±.</div>');
            }

            const week2Revenue = gameState.sales.week2.reduce((sum, s) => sum + s.revenue, 0);
            const week2Percentage = (week2Revenue / gameState.revenue) * 100;
            
            if (week2Percentage >= 50) {
                insights.push('<div class="insight-item">ğŸ“ˆ Ø§Ø³ØªØºÙ„ÙŠØª Ø°Ø±ÙˆØ© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø´ÙƒÙ„ Ù…Ù…ØªØ§Ø²!</div>');
            } else {
                insights.push('<div class="insight-item warning">âš ï¸ ÙØ§ØªØªÙƒ ÙØ±ØµØ© Ø°Ø±ÙˆØ© Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 2.</div>');
            }

            if (sellThrough >= 80) {
                insights.push('<div class="insight-item">ğŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø²ÙˆÙ† Ù…Ù…ØªØ§Ø²Ø©! Ø¨Ø¹Øª Ù…Ø¹Ø¸Ù… Ù…Ø§ Ø§Ø´ØªØ±ÙŠØª.</div>');
            } else if (sellThrough < 60) {
                insights.push('<div class="insight-item warning">âš ï¸ Ù…Ø®Ø²ÙˆÙ† ÙƒØ«ÙŠØ± Ù…ØªØ¨Ù‚ÙŠ. Ø±Ø¨Ù…Ø§ Ø§Ø´ØªØ±ÙŠØª Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ù„Ø§Ø²Ù….</div>');
            }

            return insights.join('');
        }

        function updateWeekBadge(week) {
            for (let i = 1; i <= 4; i++) {
                const badge = document.getElementById(`weekBadge${i}`);
                badge.classList.toggle('active', i === week);
            }
        }

        function goToPhase(phase) {
            for (let i = 1; i <= 6; i++) {
                const phaseEl = document.getElementById(`phase${i}`);
                if (phaseEl) {
                    phaseEl.classList.toggle('active', i === phase);
                }
            }
            gameState.currentPhase = phase;
        }

        function updateStats() {
            document.getElementById('money').textContent = `$${gameState.money.toFixed(2)}`;
            document.getElementById('inventory').textContent = Object.values(gameState.inventory).reduce((sum, i) => sum + i.quantity, 0);
            document.getElementById('revenue').textContent = `$${gameState.revenue.toFixed(2)}`;
            document.getElementById('profit').textContent = `$${(gameState.revenue - gameState.expenses).toFixed(2)}`;
            document.getElementById('sales').textContent = gameState.totalSold;
        }

        // Initialize
        initProducts();
        updateStats();
    </script>
</body>
</html>