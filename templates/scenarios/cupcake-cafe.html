<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù‚Ù‡Ù‰ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ - Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ Ù„Ù„Ø£Ø·ÙØ§Ù„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            text-align: center;
            color: white;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .back-button {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            text-decoration: none;
            transition: all 0.3s;
        }

        .back-button:hover {
            background: rgba(255,255,255,0.3);
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 3px solid #e9ecef;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stat-card .icon {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card .label {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .stat-card .value {
            font-size: 1.5em;
            font-weight: bold;
            color: #495057;
        }

        .game-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            padding: 20px;
        }

        .main-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .occasion-card {
            background: linear-gradient(135deg, #FFD3A5 0%, #FD6585 100%);
            padding: 20px;
            border-radius: 15px;
            color: white;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .occasion-icon {
            font-size: 3em;
        }

        .occasion-info h3 {
            font-size: 1.5em;
            margin-bottom: 5px;
        }

        .section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .section h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cupcake-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }

        .cupcake-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s;
            cursor: pointer;
        }

        .cupcake-card:hover {
            border-color: #f093fb;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.2);
        }

        .cupcake-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .cupcake-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .cupcake-cost {
            color: #dc3545;
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .cupcake-price {
            color: #28a745;
            font-size: 0.85em;
            margin-bottom: 10px;
        }

        .cupcake-quantity {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-secondary {
            background: #e9ecef;
            color: #495057;
            padding: 6px 12px;
            font-size: 0.9em;
        }

        .btn-secondary:hover {
            background: #dee2e6;
        }

        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quantity {
            font-size: 1.1em;
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .ingredients-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .ingredient-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .ingredient-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ingredient-icon {
            font-size: 1.5em;
        }

        .decoration-section {
            margin-top: 15px;
        }

        .decoration-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .decoration-btn {
            padding: 12px;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .decoration-btn:hover {
            border-color: #f093fb;
        }

        .decoration-btn.active {
            border-color: #f093fb;
            background: #fff5f8;
            color: #f093fb;
            font-weight: bold;
        }

        .decoration-icon {
            font-size: 2em;
            display: block;
            margin-bottom: 5px;
        }

        .cost-summary {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .cost-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e9ecef;
        }

        .cost-row:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.1em;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            flex: 1;
            padding: 15px;
            font-size: 1.2em;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4);
        }

        .btn-reset {
            background: #dc3545;
            color: white;
            padding: 15px 30px;
            font-size: 1.1em;
        }

        .btn-reset:hover {
            background: #c82333;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .event-card {
            background: #fff3cd;
            padding: 20px;
            border-radius: 15px;
            border-right: 5px solid #ffc107;
        }

        .event-card h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .tips-card {
            background: #d1ecf1;
            padding: 20px;
            border-radius: 15px;
        }

        .tips-card h3 {
            color: #0c5460;
            margin-bottom: 15px;
        }

        .tip-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .inventory-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-content h2 {
            font-size: 2em;
            margin-bottom: 20px;
            color: #495057;
        }

        .result-stat {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        @media (max-width: 768px) {
            .game-content {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }

            .header h1 {
                font-size: 1.8em;
            }

            .back-button {
                position: static;
                transform: none;
                display: inline-block;
                margin-bottom: 10px;
            }

            .cupcake-grid {
                grid-template-columns: 1fr;
            }

            .decoration-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="#" class="back-button">ğŸ§ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨ â†’</a>
            <h1>Ù…Ù‚Ù‡Ù‰ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ</h1>
        </div>

        <div class="stats-bar">
            <div class="stat-card">
                <div class="icon">ğŸ’µ</div>
                <div class="label">Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„</div>
                <div class="value" id="money">$75.00</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“…</div>
                <div class="label">Ø§Ù„ÙŠÙˆÙ…</div>
                <div class="value" id="day">1</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­</div>
                <div class="value" id="totalProfit">$0.00</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ§</div>
                <div class="label">Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ø§Ù„Ù…Ø¨Ø§Ø¹</div>
                <div class="value" id="cupcakesSold">0</div>
            </div>
            <div class="stat-card">
                <div class="icon">â­</div>
                <div class="label">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¬ÙˆØ¯Ø©</div>
                <div class="value" id="quality">5.0</div>
            </div>
        </div>

        <div class="game-content">
            <div class="main-panel">
                <div class="occasion-card">
                    <div class="occasion-icon" id="occasionIcon">ğŸ‚</div>
                    <div class="occasion-info">
                        <h3 id="occasionName">Ù…ÙˆØ³Ù… Ø§Ù„Ø­ÙÙ„Ø§Øª</h3>
                        <p id="occasionDesc">Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ!</p>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ§ Ø§Ø®ØªØ± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ</h2>
                    <div class="cupcake-grid" id="cupcakeGrid"></div>
                </div>

                <div class="section">
                    <h2>ğŸ¨ Ø§Ù„ØªØ²ÙŠÙŠÙ† ÙˆØ§Ù„Ø¥Ø¶Ø§ÙØ§Øª</h2>
                    <div class="decoration-section">
                        <h4>Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ²ÙŠÙŠÙ†:</h4>
                        <div class="decoration-options">
                            <button class="decoration-btn active" data-level="basic" onclick="selectDecoration(this)">
                                <span class="decoration-icon">âœ¨</span>
                                <div>Ø¨Ø³ÙŠØ·</div>
                                <div style="font-size: 0.8em; color: #6c757d;">Ù…Ø¬Ø§Ù†ÙŠ</div>
                            </button>
                            <button class="decoration-btn" data-level="standard" onclick="selectDecoration(this)">
                                <span class="decoration-icon">ğŸŒŸ</span>
                                <div>Ù…ØªÙˆØ³Ø·</div>
                                <div style="font-size: 0.8em; color: #6c757d;">$0.30/Ù‚Ø·Ø¹Ø©</div>
                            </button>
                            <button class="decoration-btn" data-level="premium" onclick="selectDecoration(this)">
                                <span class="decoration-icon">ğŸ’</span>
                                <div>ÙØ§Ø®Ø±</div>
                                <div style="font-size: 0.8em; color: #6c757d;">$0.60/Ù‚Ø·Ø¹Ø©</div>
                            </button>
                        </div>
                    </div>

                    <div class="ingredients-section">
                        <h4>ğŸ¥„ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©:</h4>
                        <div class="ingredient-item">
                            <div class="ingredient-info">
                                <span class="ingredient-icon">ğŸ«</span>
                                <div>
                                    <div style="font-weight: bold;">Ø±Ù‚Ø§Ø¦Ù‚ Ø§Ù„Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©</div>
                                    <div style="font-size: 0.85em; color: #6c757d;">$0.20 Ù„ÙƒÙ„ 10 Ù‚Ø·Ø¹</div>
                                </div>
                            </div>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <button class="btn btn-secondary" onclick="changeIngredient('chocolate', -1)">-</button>
                                <span class="quantity" id="chocolate">0</span>
                                <button class="btn btn-secondary" onclick="changeIngredient('chocolate', 1)">+</button>
                            </div>
                        </div>

                        <div class="ingredient-item">
                            <div class="ingredient-info">
                                <span class="ingredient-icon">ğŸ“</span>
                                <div>
                                    <div style="font-weight: bold;">ÙÙˆØ§ÙƒÙ‡ Ø·Ø§Ø²Ø¬Ø©</div>
                                    <div style="font-size: 0.85em; color: #6c757d;">$0.40 Ù„ÙƒÙ„ 10 Ù‚Ø·Ø¹</div>
                                </div>
                            </div>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <button class="btn btn-secondary" onclick="changeIngredient('fruit', -1)">-</button>
                                <span class="quantity" id="fruit">0</span>
                                <button class="btn btn-secondary" onclick="changeIngredient('fruit', 1)">+</button>
                            </div>
                        </div>

                        <div class="ingredient-item">
                            <div class="ingredient-info">
                                <span class="ingredient-icon">ğŸŒ°</span>
                                <div>
                                    <div style="font-weight: bold;">Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</div>
                                    <div style="font-size: 0.85em; color: #6c757d;">$0.30 Ù„ÙƒÙ„ 10 Ù‚Ø·Ø¹</div>
                                </div>
                            </div>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <button class="btn btn-secondary" onclick="changeIngredient('nuts', -1)">-</button>
                                <span class="quantity" id="nuts">0</span>
                                <button class="btn btn-secondary" onclick="changeIngredient('nuts', 1)">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="cost-summary">
                    <div class="cost-row">
                        <span>ØªÙƒÙ„ÙØ© Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ</span>
                        <span id="cupcakeCost">$0.00</span>
                    </div>
                    <div class="cost-row">
                        <span>ØªÙƒÙ„ÙØ© Ø§Ù„ØªØ²ÙŠÙŠÙ†</span>
                        <span id="decorationCost">$0.00</span>
                    </div>
                    <div class="cost-row">
                        <span>ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª</span>
                        <span id="ingredientCost">$0.00</span>
                    </div>
                    <div class="cost-row">
                        <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</span>
                        <span id="totalCost">$0.00</span>
                    </div>
                    <div class="cost-row">
                        <span>Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</span>
                        <span id="remainingMoney">$75.00</span>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-reset" onclick="resetDay()">â†º Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
                    <button class="btn btn-primary" onclick="openCafe()">ğŸª Ø§ÙØªØ­ Ø§Ù„Ù…Ù‚Ù‡Ù‰!</button>
                </div>
            </div>

            <div class="sidebar">
                <div class="event-card">
                    <h3>ğŸ‰ Ø­Ø¯Ø« Ø§Ù„ÙŠÙˆÙ…</h3>
                    <h4 id="eventTitle">Ù…ÙˆØ³Ù… Ø§Ù„Ø­ÙÙ„Ø§Øª!</h4>
                    <p id="eventDesc">Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ù„Ù„Ø­ÙÙ„Ø§Øª ÙˆØ§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª!</p>
                </div>

                <div class="tips-card">
                    <h3>ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ø§Ø­ØªØ±Ø§ÙÙŠØ©</h3>
                    <div class="tip-item">ğŸ¨ Ø§Ù„ØªØ²ÙŠÙŠÙ† Ø§Ù„Ø¬ÙŠØ¯ ÙŠØ²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø·Ù„Ø¨.</div>
                    <div class="tip-item">ğŸ« Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© ØªØ¬Ø¹Ù„ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ø£ÙƒØ«Ø± Ø¬Ø§Ø°Ø¨ÙŠØ©.</div>
                    <div class="tip-item">â­ Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ© ØªØ¨Ù†ÙŠ Ø³Ù…Ø¹Ø© Ø§Ù„Ù…Ù‚Ù‡Ù‰.</div>
                    <div class="tip-item">ğŸ’° ÙˆØ§Ø²Ù† Ø¨ÙŠÙ† Ø§Ù„ØªÙƒÙ„ÙØ© ÙˆØ§Ù„Ø³Ø¹Ø± Ø¨Ø°ÙƒØ§Ø¡.</div>
                    <div class="tip-item">ğŸ“Š ØªØ§Ø¨Ø¹ Ø£ÙŠ Ø§Ù„Ù†ÙƒÙ‡Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹.</div>
                </div>

                <div class="section">
                    <h2>ğŸ“¦ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h2>
                    <div class="inventory-grid" id="inventoryDisplay">
                        <p style="grid-column: 1/-1; text-align: center; color: #6c757d;">Ø§Ø´ØªØ± Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ù„Ø±Ø¤ÙŠØ© Ù…Ø®Ø²ÙˆÙ†Ùƒ</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="resultModal">
        <div class="modal-content">
            <h2>ğŸ‰ Ø§Ù„ÙŠÙˆÙ… Ù…ÙƒØªÙ…Ù„!</h2>
            <div class="result-stat">
                <span>Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ø§Ù„Ù…Ø¨Ø§Ø¹</span>
                <strong id="resultCupcakes">0</strong>
            </div>
            <div class="result-stat">
                <span>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</span>
                <strong id="resultRevenue">$0.00</strong>
            </div>
            <div class="result-stat">
                <span>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</span>
                <strong id="resultExpenses">$0.00</strong>
            </div>
            <div class="result-stat">
                <span>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ</span>
                <strong id="resultProfit" style="color: #28a745;">$0.00</strong>
            </div>
            <div class="result-stat">
                <span>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¬ÙˆØ¯Ø©</span>
                <strong id="resultQuality">5.0 â­</strong>
            </div>
            <div class="action-buttons" style="margin-top: 20px;">
                <button class="btn btn-reset" onclick="endGame()">ğŸ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                <button class="btn btn-primary" onclick="nextDay()">â† Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>
        </div>
    </div>

    <script>
        const cupcakes = [
            { id: 1, name: 'ÙØ§Ù†ÙŠÙ„ÙŠØ§', icon: 'ğŸ§', cost: 1.5, basePrice: 4, popularity: 'high' },
            { id: 2, name: 'Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©', icon: 'ğŸ«', cost: 2, basePrice: 4.5, popularity: 'high' },
            { id: 3, name: 'ÙØ±Ø§ÙˆÙ„Ø©', icon: 'ğŸ“', cost: 2.2, basePrice: 5, popularity: 'medium' },
            { id: 4, name: 'Ø£Ø­Ù…Ø± Ù…Ø®Ù…Ù„ÙŠ', icon: 'â¤ï¸', cost: 2.5, basePrice: 5.5, popularity: 'medium' },
            { id: 5, name: 'Ù„ÙŠÙ…ÙˆÙ†', icon: 'ğŸ‹', cost: 1.8, basePrice: 4.5, popularity: 'low' },
            { id: 6, name: 'Ø¬ÙˆØ² Ø§Ù„Ù‡Ù†Ø¯', icon: 'ğŸ¥¥', cost: 2.3, basePrice: 5, popularity: 'low' }
        ];

        const gameState = {
            money: 75,
            day: 1,
            totalProfit: 0,
            totalCupcakesSold: 0,
            quality: 5.0,
            cart: {},
            inventory: {},
            decoration: 'basic',
            ingredients: {
                chocolate: 0,
                fruit: 0,
                nuts: 0
            },
            occasion: null
        };

        const decorationCosts = {
            basic: 0,
            standard: 0.30,
            premium: 0.60
        };

        const ingredientCosts = {
            chocolate: 0.20,
            fruit: 0.40,
            nuts: 0.30
        };

        const occasions = [
            { icon: 'ğŸ‚', name: 'Ù…ÙˆØ³Ù… Ø§Ù„Ø­ÙÙ„Ø§Øª', desc: 'Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ù„Ù„Ø­ÙÙ„Ø§Øª ÙˆØ§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª!', multiplier: 1.5 },
            { icon: 'ğŸ’', name: 'Ø¹ÙŠØ¯ Ø§Ù„Ø­Ø¨', desc: 'Ø§Ù„Ù†Ø§Ø³ ÙŠØ´ØªØ±ÙˆÙ† Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ ÙƒÙ‡Ø¯Ø§ÙŠØ§ Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ©!', multiplier: 1.4 },
            { icon: 'ğŸ“', name: 'Ù…ÙˆØ³Ù… Ø§Ù„ØªØ®Ø±Ø¬', desc: 'Ø­ÙÙ„Ø§Øª Ø§Ù„ØªØ®Ø±Ø¬ ØªØ­ØªØ§Ø¬ Ù„Ù„ÙƒØ¨ ÙƒÙŠÙƒ!', multiplier: 1.3 },
            { icon: 'â˜€ï¸', name: 'ÙŠÙˆÙ… Ø¹Ø§Ø¯ÙŠ', desc: 'ÙŠÙˆÙ… Ø¹Ø§Ø¯ÙŠ ÙÙŠ Ø§Ù„Ù…Ù‚Ù‡Ù‰.', multiplier: 1.0 }
        ];

        function initGame() {
            setRandomOccasion();
            renderCupcakeGrid();
            updateDisplay();
        }

        function setRandomOccasion() {
            gameState.occasion = occasions[Math.floor(Math.random() * occasions.length)];
            document.getElementById('occasionIcon').textContent = gameState.occasion.icon;
            document.getElementById('occasionName').textContent = gameState.occasion.name;
            document.getElementById('occasionDesc').textContent = gameState.occasion.desc;
        }

        function renderCupcakeGrid() {
            const grid = document.getElementById('cupcakeGrid');
            grid.innerHTML = '';

            cupcakes.forEach(cupcake => {
                const card = document.createElement('div');
                card.className = 'cupcake-card';
                card.innerHTML = `
                    <div class="cupcake-icon">${cupcake.icon}</div>
                    <div class="cupcake-name">${cupcake.name}</div>
                    <div class="cupcake-cost">Ø§Ù„ØªÙƒÙ„ÙØ©: $${cupcake.cost}</div>
                    <div class="cupcake-price">Ø§Ù„Ø³Ø¹Ø±: $${cupcake.basePrice}</div>
                    <div class="cupcake-quantity">
                        <button class="btn btn-secondary" onclick="changeCupcakeQuantity(${cupcake.id}, -1)">-</button>
                        <span class="quantity" id="cupcake-${cupcake.id}">0</span>
                        <button class="btn btn-secondary" onclick="changeCupcakeQuantity(${cupcake.id}, 1)">+</button>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function changeCupcakeQuantity(cupcakeId, change) {
            const cupcake = cupcakes.find(c => c.id === cupcakeId);
            const currentQty = gameState.cart[cupcakeId] || 0;
            const newQty = Math.max(0, currentQty + change);

            if (change > 0) {
                const totalCost = calculateTotalCost() + cupcake.cost;
                if (totalCost > gameState.money) {
                    alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù†Ù‚ÙˆØ¯ ÙƒØ§ÙÙŠØ©!');
                    return;
                }
            }

            if (newQty === 0) {
                delete gameState.cart[cupcakeId];
            } else {
                gameState.cart[cupcakeId] = newQty;
            }

            document.getElementById(`cupcake-${cupcakeId}`).textContent = newQty;
            updateDisplay();
        }

        function selectDecoration(btn) {
            const siblings = btn.parentElement.querySelectorAll('.decoration-btn');
            siblings.forEach(s => s.classList.remove('active'));
            btn.classList.add('active');
            gameState.decoration = btn.dataset.level;
            updateDisplay();
        }

        function changeIngredient(type, change) {
            const newValue = Math.max(0, gameState.ingredients[type] + change);
            
            if (change > 0) {
                const totalCost = calculateTotalCost() + ingredientCosts[type];
                if (totalCost > gameState.money) {
                    alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù†Ù‚ÙˆØ¯ ÙƒØ§ÙÙŠØ©!');
                    return;
                }
            }

            gameState.ingredients[type] = newValue;
            document.getElementById(type).textContent = newValue;
            updateDisplay();
        }

        function calculateTotalCost() {
            let cupcakeCost = 0;
            for (let id in gameState.cart) {
                const cupcake = cupcakes.find(c => c.id === parseInt(id));
                cupcakeCost += cupcake.cost * gameState.cart[id];
            }

            const totalCupcakes = Object.values(gameState.cart).reduce((a, b) => a + b, 0);
            const decorationCost = totalCupcakes * decorationCosts[gameState.decoration];

            let ingredientCost = 0;
            for (let type in gameState.ingredients) {
                ingredientCost += gameState.ingredients[type] * ingredientCosts[type];
            }

            return cupcakeCost + decorationCost + ingredientCost;
        }

        function updateDisplay() {
            document.getElementById('money').textContent = '$' + gameState.money.toFixed(2);
            document.getElementById('day').textContent = gameState.day;
            document.getElementById('totalProfit').textContent = '$' + gameState.totalProfit.toFixed(2);
            document.getElementById('cupcakesSold').textContent = gameState.totalCupcakesSold;
            document.getElementById('quality').textContent = gameState.quality.toFixed(1);

            let cupcakeCost = 0;
            for (let id in gameState.cart) {
                const cupcake = cupcakes.find(c => c.id === parseInt(id));
                cupcakeCost += cupcake.cost * gameState.cart[id];
            }

            const totalCupcakes = Object.values(gameState.cart).reduce((a, b) => a + b, 0);
            const decorationCost = totalCupcakes * decorationCosts[gameState.decoration];

            let ingredientCost = 0;
            for (let type in gameState.ingredients) {
                ingredientCost += gameState.ingredients[type] * ingredientCosts[type];
            }

            const totalCost = cupcakeCost + decorationCost + ingredientCost;

            document.getElementById('cupcakeCost').textContent = '$' + cupcakeCost.toFixed(2);
            document.getElementById('decorationCost').textContent = '$' + decorationCost.toFixed(2);
            document.getElementById('ingredientCost').textContent = '$' + ingredientCost.toFixed(2);
            document.getElementById('totalCost').textContent = '$' + totalCost.toFixed(2);
            document.getElementById('remainingMoney').textContent = '$' + (gameState.money - totalCost).toFixed(2);

            updateInventoryDisplay();
        }

        function updateInventoryDisplay() {
            const container = document.getElementById('inventoryDisplay');
            const hasInventory = Object.keys(gameState.inventory).length > 0;

            if (!hasInventory) {
                container.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #6c757d;">Ø§Ø´ØªØ± Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ù„Ø±Ø¤ÙŠØ© Ù…Ø®Ø²ÙˆÙ†Ùƒ</p>';
                return;
            }

            container.innerHTML = '';
            for (let id in gameState.inventory) {
                const cupcake = cupcakes.find(c => c.id === parseInt(id));
                const qty = gameState.inventory[id];
                if (qty > 0) {
                    const div = document.createElement('div');
                    div.className = 'inventory-item';
                    div.innerHTML = `
                        <div style="font-size: 1.5em;">${cupcake.icon}</div>
                        <div style="font-size: 0.9em; color: #6c757d;">${cupcake.name}</div>
                        <div style="font-weight: bold;">${qty}</div>
                    `;
                    container.appendChild(div);
                }
            }
        }

        function openCafe() {
            const totalCost = calculateTotalCost();

            if (totalCost > gameState.money) {
                alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù†Ù‚ÙˆØ¯ ÙƒØ§ÙÙŠØ©!');
                return;
            }

            if (Object.keys(gameState.cart).length === 0) {
                alert('Ø§Ø®ØªØ± Ø¨Ø¹Ø¶ Ø§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ø£ÙˆÙ„Ø§Ù‹!');
                return;
            }

            gameState.money -= totalCost;
            for (let id in gameState.cart) {
                if (!gameState.inventory[id]) {
                    gameState.inventory[id] = 0;
                }
                gameState.inventory[id] += gameState.cart[id];
            }

            gameState.cart = {};
            cupcakes.forEach(cupcake => {
                document.getElementById(`cupcake-${cupcake.id}`).textContent = '0';
            });

            simulateSales();
        }

        function simulateSales() {
            let totalSold = 0;
            let totalRevenue = 0;
            const expenses = calculateTotalCost();

            let qualityBonus = 1.0;
            if (gameState.decoration === 'standard') qualityBonus = 1.2;
            else if (gameState.decoration === 'premium') qualityBonus = 1.5;

            const totalIngredients = Object.values(gameState.ingredients).reduce((a, b) => a + b, 0);
            if (totalIngredients > 0) qualityBonus *= 1.15;

            for (let id in gameState.inventory) {
                const cupcake = cupcakes.find(c => c.id === parseInt(id));
                const available = gameState.inventory[id];

                if (available > 0) {
                    let demandMod = 1.0;
                    if (cupcake.popularity === 'high') demandMod = 1.4;
                    else if (cupcake.popularity === 'low') demandMod = 0.8;

                    const potentialSales = Math.floor(available * 0.7 * gameState.occasion.multiplier * demandMod * qualityBonus);
                    const actualSales = Math.min(potentialSales, available);

                    let price = cupcake.basePrice;
                    if (gameState.decoration === 'standard') price += 1;
                    else if (gameState.decoration === 'premium') price += 2;

                    gameState.inventory[id] -= actualSales;
                    totalSold += actualSales;
                    totalRevenue += actualSales * price;
                }
            }

            const profit = totalRevenue - expenses;
            gameState.money += totalRevenue;
            gameState.totalCupcakesSold += totalSold;
            gameState.totalProfit += profit;

            if (qualityBonus > 1.3) {
                gameState.quality = Math.min(5.0, gameState.quality + 0.1);
            } else if (qualityBonus < 1.1) {
                gameState.quality = Math.max(3.0, gameState.quality - 0.1);
            }

            showResults(totalSold, totalRevenue, expenses, profit);
        }

        function showResults(sold, revenue, expenses, profit) {
            document.getElementById('resultCupcakes').textContent = sold;
            document.getElementById('resultRevenue').textContent = '$' + revenue.toFixed(2);
            document.getElementById('resultExpenses').textContent = '$' + expenses.toFixed(2);
            document.getElementById('resultProfit').textContent = '$' + profit.toFixed(2);
            document.getElementById('resultQuality').textContent = gameState.quality.toFixed(1) + ' â­';

            const profitElement = document.getElementById('resultProfit');
            profitElement.style.color = profit >= 0 ? '#28a745' : '#dc3545';

            document.getElementById('resultModal').classList.add('active');
        }

        function nextDay() {
            gameState.day++;
            gameState.ingredients = { chocolate: 0, fruit: 0, nuts: 0 };
            document.getElementById('chocolate').textContent = '0';
            document.getElementById('fruit').textContent = '0';
            document.getElementById('nuts').textContent = '0';
            setRandomOccasion();
            document.getElementById('resultModal').classList.remove('active');
            updateDisplay();
        }

        function resetDay() {
            gameState.cart = {};
            gameState.decoration = 'basic';
            gameState.ingredients = { chocolate: 0, fruit: 0, nuts: 0 };

            document.querySelectorAll('.decoration-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.level === 'basic') {
                    btn.classList.add('active');
                }
            });

            cupcakes.forEach(cupcake => {
                document.getElementById(`cupcake-${cupcake.id}`).textContent = '0';
            });

            document.getElementById('chocolate').textContent = '0';
            document.getElementById('fruit').textContent = '0';
            document.getElementById('nuts').textContent = '0';

            updateDisplay();
        }

        function endGame() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ')) {
                alert(`Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù†ØªÙ‡Øª!\n\nØ§Ù„Ø£ÙŠØ§Ù…: ${gameState.day}\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­: $${gameState.totalProfit.toFixed(2)}\nØ§Ù„ÙƒØ¨ ÙƒÙŠÙƒ Ø§Ù„Ù…Ø¨Ø§Ø¹: ${gameState.totalCupcakesSold}\nØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¬ÙˆØ¯Ø©: ${gameState.quality.toFixed(1)}`);
                location.reload();
            }
        }

        initGame();
    </script>
</body>
</html>