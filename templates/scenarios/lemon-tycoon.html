<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ÙƒØ´Ùƒ Ø§Ù„Ù„ÙŠÙ…ÙˆÙ†Ø§Ø¯Ø© - Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¬Ø§Ø±ÙŠ Ù„Ù„Ø£Ø·ÙØ§Ù„</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #4caf50;
            --secondary-color: #ff9800;
            --background: #f5f5f5;
            --card-bg: #ffffff;
            --text-primary: #2e7d32;
            --text-secondary: #666;
            --border-color: #e0e0e0;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);
            min-height: 100vh;
            padding-bottom: 2rem;
        }

        .game-header {
            background: linear-gradient(135deg, #ffd54f, #ffb74d);
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .game-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-primary);
            font-weight: 800;
            font-size: 2rem;
        }

        .back-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: white;
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .back-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .stats-bar {
            background: white;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stats-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1.5rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .stat-value {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .game-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
        }

        .game-board {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .board-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-radius: 12px;
        }

        .day-info {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .weather-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.2rem;
        }

        .weather-icon {
            font-size: 2rem;
        }

        .control-section {
            margin-bottom: 2rem;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid var(--primary-color);
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .control-card {
            background: var(--background);
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            transition: all 0.3s;
        }

        .control-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(76,175,80,0.2);
        }

        .control-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .control-input {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .quantity-btn {
            width: 45px;
            height: 45px;
            border: none;
            background: var(--primary-color);
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quantity-btn:hover {
            background: var(--text-primary);
            transform: scale(1.1);
        }

        .quantity-display {
            font-size: 2rem;
            font-weight: 800;
            color: var(--text-primary);
            min-width: 60px;
            text-align: center;
        }

        .cost-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: var(--text-secondary);
            padding-top: 0.5rem;
            border-top: 1px solid var(--border-color);
        }

        .cost-info span:last-child {
            font-weight: 700;
            color: var(--primary-color);
        }

        .slider-container {
            padding: 1rem 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: var(--border-color);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            flex: 1;
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-family: 'Cairo', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--text-primary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(76,175,80,0.4);
        }

        .btn-secondary {
            background: white;
            color: var(--text-primary);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--background);
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .info-panel {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border-color);
        }

        .event-card {
            background: linear-gradient(135deg, #fff9c4, #fff59d);
            padding: 1.5rem;
            border-radius: 12px;
            border-right: 4px solid var(--secondary-color);
        }

        .event-title {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .event-description {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .tips-list {
            list-style: none;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: var(--background);
            border-radius: 8px;
            transition: all 0.3s;
        }

        .tip-item:hover {
            background: #e8f5e9;
            transform: translateX(-5px);
        }

        .tip-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .result-item {
            background: var(--background);
            padding: 1.5rem;
            border-radius: 12px;
        }

        .result-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .chart-container {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 150px;
            padding: 1rem;
            background: var(--background);
            border-radius: 8px;
        }

        .chart-bar {
            width: 100%;
            background: linear-gradient(to top, var(--primary-color), #81c784);
            border-radius: 8px 8px 0 0;
            transition: all 0.3s;
            cursor: pointer;
        }

        .chart-bar:hover {
            opacity: 0.8;
        }

        .chart-label {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: center;
        }

        @media (max-width: 1200px) {
            .game-container {
                grid-template-columns: 1fr;
            }

            .control-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .game-title {
                font-size: 1.5rem;
            }

            .stats-container {
                flex-direction: column;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Game Header -->
    <header class="game-header">
        <div class="header-content">
            <div class="game-title">
                <span style="font-size: 2rem">ğŸ‹</span>
                <h1>ÙƒØ´Ùƒ Ø§Ù„Ù„ÙŠÙ…ÙˆÙ†Ø§Ø¯Ø©</h1>
            </div>
            <a href="{% url "scenarios:scenario_list" %}" class="back-link">
                <span>â†’</span>
                <span>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨</span>
            </a>
        </div>
    </header>

    <!-- Stats Bar -->
    <div class="stats-bar">
        <div class="stats-container">
            <div class="stat-item">
                <div class="stat-label">Ø§Ù„Ù†Ù‚ÙˆØ¯</div>
                <div class="stat-value">
                    <span>ğŸ’µ</span>
                    <span id="cashDisplay">$50.00</span>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Ø§Ù„ÙŠÙˆÙ…</div>
                <div class="stat-value">
                    <span>ğŸ“…</span>
                    <span id="dayDisplay">1</span>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­</div>
                <div class="stat-value">
                    <span>ğŸ’°</span>
                    <span id="profitDisplay">$0.00</span>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Ø§Ù„Ø£ÙƒÙˆØ§Ø¨ Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</div>
                <div class="stat-value">
                    <span>ğŸ¥¤</span>
                    <span id="cupsSoldDisplay">0</span>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Ø§Ù„Ø³Ù…Ø¹Ø©</div>
                <div class="stat-value">
                    <span>â­</span>
                    <span id="reputationDisplay">5.0</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Game Area -->
    <div class="game-container">
        <!-- Game Board -->
        <div class="game-board">
            <div class="board-header">
                <div class="day-info">
                    <div class="day-number">Ø§Ù„ÙŠÙˆÙ… <span id="currentDay">1</span></div>
                </div>
                <div class="weather-info">
                    <span class="weather-icon" id="weatherIcon">â˜€ï¸</span>
                    <span id="weatherText">Ù…Ø´Ù…Ø³ ÙˆØ­Ø§Ø±</span>
                    <span id="temperature">29Â°Ù…</span>
                </div>
            </div>

            <!-- Inventory Section -->
            <div class="control-section">
                <div class="section-title">
                    <span>ğŸ“¦</span>
                    <span>Ø´Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª</span>
                </div>
                <div class="control-grid">
                    <div class="control-card">
                        <div class="control-label">
                            <span>ğŸ‹</span>
                            <span>Ø§Ù„Ù„ÙŠÙ…ÙˆÙ†</span>
                        </div>
                        <div class="control-input">
                            <button class="quantity-btn" onclick="adjustQuantity('lemons', -10)">-</button>
                            <div class="quantity-display" id="lemonsQty">0</div>
                            <button class="quantity-btn" onclick="adjustQuantity('lemons', 10)">+</button>
                        </div>
                        <div class="cost-info">
                            <span>$0.50 Ù„ÙƒÙ„ 10</span>
                            <span id="lemonsCost">$0.00</span>
                        </div>
                    </div>

                    <div class="control-card">
                        <div class="control-label">
                            <span>ğŸ§‚</span>
                            <span>Ø§Ù„Ø³ÙƒØ±</span>
                        </div>
                        <div class="control-input">
                            <button class="quantity-btn" onclick="adjustQuantity('sugar', -10)">-</button>
                            <div class="quantity-display" id="sugarQty">0</div>
                            <button class="quantity-btn" onclick="adjustQuantity('sugar', 10)">+</button>
                        </div>
                        <div class="cost-info">
                            <span>$0.30 Ù„ÙƒÙ„ 10</span>
                            <span id="sugarCost">$0.00</span>
                        </div>
                    </div>

                    <div class="control-card">
                        <div class="control-label">
                            <span>ğŸ¥¤</span>
                            <span>Ø§Ù„Ø£ÙƒÙˆØ§Ø¨</span>
                        </div>
                        <div class="control-input">
                            <button class="quantity-btn" onclick="adjustQuantity('cups', -10)">-</button>
                            <div class="quantity-display" id="cupsQty">0</div>
                            <button class="quantity-btn" onclick="adjustQuantity('cups', 10)">+</button>
                        </div>
                        <div class="cost-info">
                            <span>$0.20 Ù„ÙƒÙ„ 10</span>
                            <span id="cupsCost">$0.00</span>
                        </div>
                    </div>

                    <div class="control-card">
                        <div class="control-label">
                            <span>ğŸ§Š</span>
                            <span>Ø§Ù„Ø«Ù„Ø¬</span>
                        </div>
                        <div class="control-input">
                            <button class="quantity-btn" onclick="adjustQuantity('ice', -10)">-</button>
                            <div class="quantity-display" id="iceQty">0</div>
                            <button class="quantity-btn" onclick="adjustQuantity('ice', 10)">+</button>
                        </div>
                        <div class="cost-info">
                            <span>$0.10 Ù„ÙƒÙ„ 10</span>
                            <span id="iceCost">$0.00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pricing Section -->
            <div class="control-section">
                <div class="section-title">
                    <span>ğŸ’µ</span>
                    <span>Ø­Ø¯Ø¯ Ø§Ù„Ø³Ø¹Ø±</span>
                </div>
                <div class="control-card">
                    <div class="control-label">
                        <span>Ø§Ù„Ø³Ø¹Ø± Ù„ÙƒÙ„ ÙƒÙˆØ¨</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="priceSlider" min="25" max="500" value="100" step="25" oninput="updatePrice()" />
                    </div>
                    <div style="text-align: center; margin-top: 1rem">
                        <div style="font-size: 2.5rem; font-weight: 800; color: var(--primary-color)" id="priceDisplay">$1.00</div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary)">Ù…ÙˆØµÙ‰ Ø¨Ù‡: $0.75 - $1.25</div>
                    </div>
                </div>
            </div>

            <!-- Recipe Quality -->
            <div class="control-section">
                <div class="section-title">
                    <span>ğŸ‘¨â€ğŸ³</span>
                    <span>Ø¬ÙˆØ¯Ø© Ø§Ù„ÙˆØµÙØ©</span>
                </div>
                <div class="control-card">
                    <div class="control-label">
                        <span>Ù†Ø³Ø¨Ø© Ø§Ù„Ù„ÙŠÙ…ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø³ÙƒØ±</span>
                    </div>
                    <div class="slider-container">
                        <input type="range" class="slider" id="recipeSlider" min="1" max="10" value="5" oninput="updateRecipe()" />
                    </div>
                    <div style="text-align: center; margin-top: 1rem">
                        <div style="font-weight: 700; color: var(--primary-color)" id="recipeQuality">Ù…ØªÙˆØ§Ø²Ù†</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem">
                            <span style="float: right">ğŸ‹ Ø­Ø§Ù…Ø¶</span>
                            <span style="float: left">Ø­Ù„Ùˆ ğŸ§‚</span>
                        </div>
                        <div style="clear: both"></div>
                    </div>
                </div>
            </div>

            <!-- Total Cost -->
            <div style="background: var(--background); padding: 1.5rem; border-radius: 12px; margin-top: 2rem">
                <div style="display: flex; justify-content: space-between; align-items: center">
                    <div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary)">Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª</div>
                        <div style="font-size: 2rem; font-weight: 800; color: var(--primary-color)" id="totalCost">$0.00</div>
                    </div>
                    <div>
                        <div style="font-size: 0.875rem; color: var(--text-secondary)">Ø§Ù„Ù†Ù‚ÙˆØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</div>
                        <div style="font-size: 2rem; font-weight: 800" id="remainingCash">$50.00</div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="resetDay()">
                    <span>â†º</span>
                    <span>Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</span>
                </button>
                <button class="btn btn-primary" onclick="startDay()">
                    <span>â–¶</span>
                    <span>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¨ÙŠØ¹!</span>
                </button>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Current Event -->
            <div class="info-panel">
                <div class="panel-title">
                    <span>ğŸ“¢</span>
                    <span>Ø­Ø¯Ø« Ø§Ù„ÙŠÙˆÙ…</span>
                </div>
                <div class="event-card" id="eventCard">
                    <div class="event-title">Ø·Ù‚Ø³ Ù…Ø«Ø§Ù„ÙŠ!</div>
                    <div class="event-description">Ø¥Ù†Ù‡ ÙŠÙˆÙ… Ù…Ø´Ù…Ø³ Ø¬Ù…ÙŠÙ„. Ø§Ù„Ù†Ø§Ø³ ÙŠØ¨Ø­Ø«ÙˆÙ† Ø¹Ù† Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ù…Ù†Ø¹Ø´Ø©!</div>
                </div>
            </div>

            <!-- Tips -->
            <div class="info-panel">
                <div class="panel-title">
                    <span>ğŸ’¡</span>
                    <span>Ù†ØµØ§Ø¦Ø­ Ø§Ø­ØªØ±Ø§ÙÙŠØ©</span>
                </div>
                <ul class="tips-list">
                    <li class="tip-item">
                        <span class="tip-icon">â˜€ï¸</span>
                        <span>Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„Ø­Ø§Ø± ÙŠØ¹Ù†ÙŠ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†! Ø§Ø´ØªØ± Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª.</span>
                    </li>
                    <li class="tip-item">
                        <span class="tip-icon">ğŸ’°</span>
                        <span>Ù„Ø§ ØªØ¨Ø§Ù„Øº ÙÙŠ Ø§Ù„ØªØ³Ø¹ÙŠØ±! Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª.</span>
                    </li>
                    <li class="tip-item">
                        <span class="tip-icon">â­</span>
                        <span>Ø§Ù„ÙˆØµÙØ§Øª Ø§Ù„Ø¬ÙŠØ¯Ø© ØªØ¨Ù†ÙŠ Ø§Ù„Ø³Ù…Ø¹Ø© ÙˆØªØ¬Ù„Ø¨ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† Ø§Ù„Ù…ØªÙƒØ±Ø±ÙŠÙ†.</span>
                    </li>
                    <li class="tip-item">
                        <span class="tip-icon">ğŸ“Š</span>
                        <span>ØªØ§Ø¨Ø¹ Ø£Ø¯Ø§Ø¡Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØªÙƒ.</span>
                    </li>
                </ul>
            </div>

            <!-- Sales History -->
            <div class="info-panel">
                <div class="panel-title">
                    <span>ğŸ“Š</span>
                    <span>Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</span>
                </div>
                <div class="chart-container" id="salesChart">
                    <div style="text-align: center; width: 100%; color: var(--text-secondary); font-size: 0.875rem">
                        Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨ÙŠØ¹Ø§Øª Ø¨Ø¹Ø¯. Ø§Ø¨Ø¯Ø£ ÙŠÙˆÙ…Ùƒ Ø§Ù„Ø£ÙˆÙ„!
                    </div>
                </div>
            </div>

            <!-- Inventory Status -->
            <div class="info-panel">
                <div class="panel-title">
                    <span>ğŸ“¦</span>
                    <span>Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ</span>
                </div>
                <div id="inventoryStatus">
                    <div style="color: var(--text-secondary); font-size: 0.875rem; text-align: center">
                        Ø§Ø´ØªØ± Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ù„Ø±Ø¤ÙŠØ© Ù…Ø®Ø²ÙˆÙ†Ùƒ
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal" id="resultsModal">
        <div class="modal-content">
            <div class="modal-icon" id="resultIcon">ğŸ‰</div>
            <h2 class="modal-title" id="resultTitle">Ø§Ù„ÙŠÙˆÙ… Ù…ÙƒØªÙ…Ù„!</h2>
            <p id="resultMessage" style="color: var(--text-secondary); margin-bottom: 2rem"></p>

            <div class="results-grid">
                <div class="result-item">
                    <div class="result-label">Ø§Ù„Ø£ÙƒÙˆØ§Ø¨ Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</div>
                    <div class="result-value" id="resultCupsSold">0</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                    <div class="result-value" id="resultRevenue">$0.00</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                    <div class="result-value" id="resultExpenses">$0.00</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Ø§Ù„Ø±Ø¨Ø­</div>
                    <div class="result-value" id="resultProfit">$0.00</div>
                </div>
            </div>

            <div class="action-buttons" style="margin-top: 2rem">
                <button class="btn btn-secondary" onclick="endGame()">
                    <span>ğŸ</span>
                    <span>Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</span>
                </button>
                <button class="btn btn-primary" onclick="nextDay()">
                    <span>â†</span>
                    <span>Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            cash: 50,
            day: 1,
            totalProfit: 0,
            reputation: 5.0,
            totalCupsSold: 0,
            inventory: {
                lemons: 0,
                sugar: 0,
                cups: 0,
                ice: 0
            },
            price: 1.0,
            recipe: 5,
            salesHistory: [],
            weather: {
                type: 'sunny',
                temperature: 29,
                modifier: 1.5
            }
        };

        const prices = {
            lemons: 0.05,
            sugar: 0.03,
            cups: 0.02,
            ice: 0.01
        };

        // Initialize game
        function initGame() {
            updateDisplay();
            generateWeather();
            generateEvent();
        }

        // Adjust quantities
        function adjustQuantity(item, amount) {
            const currentQty = gameState.inventory[item];
            const newQty = Math.max(0, currentQty + amount);
            const cost = (newQty - currentQty) * prices[item];

            if (gameState.cash >= cost || amount < 0) {
                gameState.inventory[item] = newQty;
                gameState.cash -= cost;
                updateDisplay();
            } else {
                alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ù‚ÙˆØ¯ ÙƒØ§ÙÙŠØ©!');
            }
        }

        // Update price
        function updatePrice() {
            const value = document.getElementById('priceSlider').value;
            gameState.price = value / 100;
            document.getElementById('priceDisplay').textContent = ' + gameState.price.toFixed(2);
        }

        // Update recipe
        function updateRecipe() {
            const value = document.getElementById('recipeSlider').value;
            gameState.recipe = parseInt(value);

            let quality = 'Ù…ØªÙˆØ§Ø²Ù†';
            if (value < 3) quality = 'Ø­Ø§Ù…Ø¶ Ø¬Ø¯Ø§Ù‹ ğŸ˜–';
            else if (value < 5) quality = 'Ø­Ø§Ù…Ø¶ Ù‚Ù„ÙŠÙ„Ø§Ù‹';
            else if (value == 5) quality = 'Ù…Ø«Ø§Ù„ÙŠ! â­';
            else if (value < 8) quality = 'Ø­Ù„Ùˆ Ù‚Ù„ÙŠÙ„Ø§Ù‹';
            else quality = 'Ø­Ù„Ùˆ Ø¬Ø¯Ø§Ù‹ ï¿½';

            document.getElementById('recipeQuality').textContent = quality;
        }

        // Generate weather
        function generateWeather() {
            const weathers = [
                { type: 'sunny', icon: 'â˜€ï¸', text: 'Ù…Ø´Ù…Ø³ ÙˆØ­Ø§Ø±', temp: 29, modifier: 1.5 },
                { type: 'partly', icon: 'â›…', text: 'ØºØ§Ø¦Ù… Ø¬Ø²Ø¦ÙŠØ§Ù‹', temp: 24, modifier: 1.2 },
                { type: 'cloudy', icon: 'â˜ï¸', text: 'ØºØ§Ø¦Ù…', temp: 21, modifier: 0.9 },
                { type: 'rainy', icon: 'ğŸŒ§ï¸', text: 'Ù…Ù…Ø·Ø±', temp: 18, modifier: 0.5 }
            ];

            const weather = weathers[Math.floor(Math.random() * weathers.length)];
            gameState.weather = weather;

            document.getElementById('weatherIcon').textContent = weather.icon;
            document.getElementById('weatherText').textContent = weather.text;
            document.getElementById('temperature').textContent = weather.temp + 'Â°Ù…';
        }

        // Generate event
        function generateEvent() {
            const events = [
                { title: 'Ø·Ù‚Ø³ Ù…Ø«Ø§Ù„ÙŠ!', desc: 'Ø¥Ù†Ù‡ ÙŠÙˆÙ… Ù…Ø´Ù…Ø³ Ø¬Ù…ÙŠÙ„. Ø§Ù„Ù†Ø§Ø³ ÙŠØ¨Ø­Ø«ÙˆÙ† Ø¹Ù† Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ù…Ù†Ø¹Ø´Ø©!' },
                { title: 'Ù…Ø¹Ø±Ø¶ Ù…Ø­Ù„ÙŠ Ù‚Ø±ÙŠØ¨', desc: 'Ù‡Ù†Ø§Ùƒ Ù…Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©! ØªÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„ÙŠÙˆÙ….' },
                { title: 'ØªÙ†Ø¨ÙŠÙ‡ ÙŠÙˆÙ… Ø­Ø§Ø±', desc: 'Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© ØªØ±ØªÙØ¹! Ø§Ù„Ù†Ø§Ø³ Ø³ÙŠØ¯ÙØ¹ÙˆÙ† Ø£ÙƒØ«Ø± Ù„Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©.' },
                { title: 'Ø§Ø²Ø¯Ø­Ø§Ù… Ø¹Ø·Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹', desc: 'Ø¥Ù†Ù‡Ø§ Ø¹Ø·Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹! Ø§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª ÙÙŠ Ø§Ù„Ø®Ø§Ø±Ø¬.' },
                { title: 'ÙŠÙˆÙ… Ù‡Ø§Ø¯Ø¦', desc: 'Ù„ÙŠØ³ Ù‡Ù†Ø§Ùƒ Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ù†Ø§Ø³ Ø§Ù„ÙŠÙˆÙ…. Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ù…Ù†Ø®ÙØ¶Ø©!' }
            ];

            const event = events[Math.floor(Math.random() * events.length)];
            document.getElementById('eventCard').innerHTML = `
                <div class="event-title">${event.title}</div>
                <div class="event-description">${event.desc}</div>
            `;
        }

        // Start day
        function startDay() {
            const supplies = gameState.inventory;
            const minSupplies = Math.min(
                Math.floor(supplies.lemons / 2),
                Math.floor(supplies.sugar / 2),
                supplies.cups,
                Math.floor(supplies.ice / 3)
            );

            if (minSupplies === 0) {
                alert('ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ù„ØµÙ†Ø¹ Ø§Ù„Ù„ÙŠÙ…ÙˆÙ†Ø§Ø¯Ø©! Ø§Ø´ØªØ± Ø§Ù„Ù„ÙŠÙ…ÙˆÙ† ÙˆØ§Ù„Ø³ÙƒØ± ÙˆØ§Ù„Ø£ÙƒÙˆØ§Ø¨ ÙˆØ§Ù„Ø«Ù„Ø¬.');
                return;
            }

            // Simulate sales
            const baseCustomers = Math.floor(Math.random() * 50 + 30);
            const weatherCustomers = Math.floor(baseCustomers * gameState.weather.modifier);

            // Price affects demand
            let priceModifier = 1.0;
            if (gameState.price < 0.75) priceModifier = 1.3;
            else if (gameState.price > 1.25) priceModifier = 0.6;
            else if (gameState.price > 1.5) priceModifier = 0.3;

            // Recipe affects satisfaction
            let recipeModifier = 1.0;
            if (gameState.recipe === 5) recipeModifier = 1.2;
            else if (gameState.recipe < 3 || gameState.recipe > 7) recipeModifier = 0.7;

            const totalCustomers = Math.floor(weatherCustomers * priceModifier * recipeModifier);
            const cupsSold = Math.min(totalCustomers, minSupplies);

            // Calculate results
            const revenue = cupsSold * gameState.price;
            const suppliesCost = getTotalCost();
            const profit = revenue - suppliesCost;

            // Update inventory
            gameState.inventory.lemons -= cupsSold * 2;
            gameState.inventory.sugar -= cupsSold * 2;
            gameState.inventory.cups -= cupsSold;
            gameState.inventory.ice -= cupsSold * 3;

            // Update stats
            gameState.cash += revenue;
            gameState.totalProfit += profit;
            gameState.totalCupsSold += cupsSold;

            // Update reputation
            if (gameState.recipe === 5 && gameState.price <= 1.25) {
                gameState.reputation = Math.min(5.0, gameState.reputation + 0.1);
            } else if (gameState.price > 1.5 || gameState.recipe < 3 || gameState.recipe > 7) {
                gameState.reputation = Math.max(1.0, gameState.reputation - 0.1);
            }

            // Store sales data
            gameState.salesHistory.push({
                day: gameState.day,
                cupsSold: cupsSold,
                revenue: revenue,
                profit: profit
            });

            // Show results
            showResults(cupsSold, revenue, suppliesCost, profit);
        }

        // Show results
        function showResults(cupsSold, revenue, expenses, profit) {
            document.getElementById('resultCupsSold').textContent = cupsSold;
            document.getElementById('resultRevenue').textContent = ' + revenue.toFixed(2);
            document.getElementById('resultExpenses').textContent = ' + expenses.toFixed(2);
            document.getElementById('resultProfit').textContent = ' + profit.toFixed(2);

            if (profit > 0) {
                document.getElementById('resultIcon').textContent = 'ğŸ‰';
                document.getElementById('resultTitle').textContent = 'Ø¹Ù…Ù„ Ø±Ø§Ø¦Ø¹!';
                document.getElementById('resultMessage').textContent = 'Ù„Ù‚Ø¯ Ø­Ù‚Ù‚Øª Ø±Ø¨Ø­Ø§Ù‹ Ø§Ù„ÙŠÙˆÙ…! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬ÙŠØ¯.';
            } else if (profit === 0) {
                document.getElementById('resultIcon').textContent = 'ğŸ˜';
                document.getElementById('resultTitle').textContent = 'Ø§Ù„ØªØ¹Ø§Ø¯Ù„';
                document.getElementById('resultMessage').textContent = 'Ø­Ù‚Ù‚Øª Ø§Ù„ØªØ¹Ø§Ø¯Ù„ Ø§Ù„ÙŠÙˆÙ…. Ø­Ø§ÙˆÙ„ ØªØ­Ø³ÙŠÙ† Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØªÙƒ!';
            } else {
                document.getElementById('resultIcon').textContent = 'ğŸ˜¢';
                document.getElementById('resultTitle').textContent = 'Ø®Ø³Ø§Ø±Ø© Ù…Ø§Ù„ÙŠØ©';
                document.getElementById('resultMessage').textContent = 'Ø®Ø³Ø±Øª Ø£Ù…ÙˆØ§Ù„Ø§Ù‹ Ø§Ù„ÙŠÙˆÙ…. Ø§Ø¶Ø¨Ø· Ø£Ø³Ø¹Ø§Ø±Ùƒ ÙˆØªÙƒØ§Ù„ÙŠÙÙƒ!';
            }

            document.getElementById('resultsModal').classList.add('active');
        }

        // Next day
        function nextDay() {
            gameState.day++;
            document.getElementById('resultsModal').classList.remove('active');
            generateWeather();
            generateEvent();
            resetInventoryPurchases();
            updateDisplay();
            updateSalesChart();
        }

        // Reset day
        function resetDay() {
            resetInventoryPurchases();
            updateDisplay();
        }

        // Reset inventory purchases
        function resetInventoryPurchases() {
            updateDisplay();
        }

        // End game
        function endGame() {
            const totalDays = gameState.day;
            const avgProfit = (gameState.totalProfit / totalDays).toFixed(2);

            if (confirm(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!\n\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙŠØ§Ù…: ${totalDays}\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­: ${gameState.totalProfit.toFixed(2)}\nÙ…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø¨Ø­: ${avgProfit}\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙƒÙˆØ§Ø¨ Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©: ${gameState.totalCupsSold}\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ØŸ`)) {
                location.reload();
            } else {
                window.history.back();
            }
        }

        // Get total cost
        function getTotalCost() {
            let total = 0;
            for (let item in gameState.inventory) {
                total += gameState.inventory[item] * prices[item];
            }
            return total;
        }

        // Update display
        function updateDisplay() {
            document.getElementById('cashDisplay').textContent = ' + gameState.cash.toFixed(2);
            document.getElementById('dayDisplay').textContent = gameState.day;
            document.getElementById('currentDay').textContent = gameState.day;
            document.getElementById('profitDisplay').textContent = ' + gameState.totalProfit.toFixed(2);
            document.getElementById('cupsSoldDisplay').textContent = gameState.totalCupsSold;
            document.getElementById('reputationDisplay').textContent = gameState.reputation.toFixed(1);

            // Update quantities
            document.getElementById('lemonsQty').textContent = gameState.inventory.lemons;
            document.getElementById('sugarQty').textContent = gameState.inventory.sugar;
            document.getElementById('cupsQty').textContent = gameState.inventory.cups;
            document.getElementById('iceQty').textContent = gameState.inventory.ice;

            // Update costs
            document.getElementById('lemonsCost').textContent = ' + (gameState.inventory.lemons * prices.lemons).toFixed(2);
            document.getElementById('sugarCost').textContent = ' + (gameState.inventory.sugar * prices.sugar).toFixed(2);
            document.getElementById('cupsCost').textContent = ' + (gameState.inventory.cups * prices.cups).toFixed(2);
            document.getElementById('iceCost').textContent = ' + (gameState.inventory.ice * prices.ice).toFixed(2);

            const totalCost = getTotalCost();
            document.getElementById('totalCost').textContent = ' + totalCost.toFixed(2);
            document.getElementById('remainingCash').textContent = ' + (gameState.cash - totalCost).toFixed(2);

            // Update inventory status
            updateInventoryStatus();
        }

        // Update inventory status
        function updateInventoryStatus() {
            const inv = gameState.inventory;
            const html = `
                <div style="display: grid; gap: 0.5rem;">
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--background); border-radius: 6px;">
                        <span>ğŸ‹ Ø§Ù„Ù„ÙŠÙ…ÙˆÙ†</span>
                        <span style="font-weight: 700;">${inv.lemons}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--background); border-radius: 6px;">
                        <span>ğŸ§‚ Ø§Ù„Ø³ÙƒØ±</span>
                        <span style="font-weight: 700;">${inv.sugar}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--background); border-radius: 6px;">
                        <span>ğŸ¥¤ Ø§Ù„Ø£ÙƒÙˆØ§Ø¨</span>
                        <span style="font-weight: 700;">${inv.cups}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--background); border-radius: 6px;">
                        <span>ğŸ§Š Ø§Ù„Ø«Ù„Ø¬</span>
                        <span style="font-weight: 700;">${inv.ice}</span>
                    </div>
                </div>
            `;
            document.getElementById('inventoryStatus').innerHTML = html;
        }

        // Update sales chart
        function updateSalesChart() {
            const history = gameState.salesHistory.slice(-7);
            if (history.length === 0) return;

            const maxSales = Math.max(...history.map(d => d.cupsSold));

            let html = '';
            history.forEach((data, index) => {
                const height = (data.cupsSold / maxSales) * 100;
                html += `
                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                        <div class="chart-bar" style="height: ${height}%" title="Ø§Ù„ÙŠÙˆÙ… ${data.day}: ${data.cupsSold} Ø£ÙƒÙˆØ§Ø¨"></div>
                        <div class="chart-label">ÙŠ${data.day}</div>
                    </div>
                `;
            });

            document.getElementById('salesChart').innerHTML = html;
        }

        // Initialize on load
        window.addEventListener('load', initGame);
    </script>
</body>
</html>